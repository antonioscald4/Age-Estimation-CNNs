# -*- coding: utf-8 -*-
"""Test.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fl7gIjIFiM3HWI4WmHfwvveZY6bAjlZ8
"""

import tensorflow as tf
gpus = tf.config.list_physical_devices('GPU')
if gpus:  
  try:
    tf.config.set_logical_device_configuration(gpus[0],[tf.config.LogicalDeviceConfiguration(memory_limit=8192)])
    logical_gpus = tf.config.list_logical_devices('GPU')
    print(len(gpus), "Physical GPUs,", len(logical_gpus), "Logical GPUs")
  except RuntimeError as e:
    print(e)

#from google.colab import drive
#drive.mount('/content/drive')

#!unzip -q "/content/drive/MyDrive/AV_Project/training_caip_contest.zip"

import zipfile
with zipfile.ZipFile('training_caip_contest.zip', 'r') as zip_ref:
    zip_ref.extractall('/mnt/sdc1/2022_va_gr15/dataset_for_vgg_undersampling_v3/')

#read labels
import csv
import numpy as np
# list to store all labels
labels = []

with open('dataset.csv', newline='') as file:
  reader = csv.reader(file, delimiter = ',')
  for row in reader:
    labels.append(row[1])
  labels = np.array(labels)
print(labels[0])
print(len(labels))

import pandas as pd
data = pd.read_csv("dataset.csv",)
histogram_age = data['27'].hist(bins=data['27'].nunique())

import pandas as pd

labels, values = np.unique(labels, return_counts=True)
age_df = pd.DataFrame(data = values, index = labels, columns = ['Freq'])

print(age_df)

print(age_df.describe())

print(age_df.loc[age_df.idxmax()])

print(age_df.loc[age_df.idxmin()])

age_lst = list(age_df.index.values)
print(age_lst)

#Find missing ages
miss_ages = []
for age in range(81):
  if str(age) not in age_lst:
    miss_ages.append(age)

print(miss_ages)

#read labels
import csv
import numpy as np
# list to store all labels
labels = []

with open('dataset.csv', newline='') as file:
  reader = csv.reader(file, delimiter = ',')
  for row in reader:
    labels.append(row[1])
  labels = np.array(labels)
print(labels[0])

import os
data_dir = '/mnt/sdc1/2022_va_gr15/dataset_for_vgg_undersampling_v3/training_caip_contest/'

files = os.listdir(data_dir)
print("Total Image: ")
print(len(files))

'''
#import gdown
import PIL.Image
import numpy as np
import matplotlib.pyplot as plt
plt.figure()
plt.title('Imagename: {}, Age: {}'.format("0.jpg", labels[0]), color = 'red')
plt.imshow(PIL.Image.open('/mnt/sdc1/2022_va_gr15/training_caip_contest/0.jpg'))

plt.figure()
plt.title('Imagename: {}, Age: {}'.format("1.jpg", labels[1]), color = 'red')
plt.imshow(PIL.Image.open('/mnt/sdc1/2022_va_gr15/training_caip_contest/1.jpg'))

plt.figure()
plt.title('Imagename: {}, Age: {}'.format("2.jpg", labels[2]), color = 'red')
plt.imshow(PIL.Image.open('/mnt/sdc1/2022_va_gr15/training_caip_contest/2.jpg'))
'''
